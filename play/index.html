<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Game</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body style="overflow: hidden; background-color: black;">
<script>
class l{constructor(a,b,d=1,c="square",e=2,g=.5){this.g=null;this.h=a;this.gain=a.createGain();this.i=b.map(f=>Array.from(f));this.j=d;this.type=c;this.m=e;this.l=g}stop(){null!=this.g&&(this.g.stop(0),this.g.disconnect(),this.g=null)}play(a){this.stop();let b=this.h.currentTime,d;this.g=this.h.createOscillator();this.g.type=this.type;a*=this.j;this.g.frequency.setValueAtTime(this.i[0][0],b);this.gain.gain.setValueAtTime(Math.min(1,Math.max(a,.01)),b);d=0;for(let c of this.i){switch(this.m){case 0:this.g.frequency.setValueAtTime(c[0],
b+d);break;case 1:this.g.frequency.linearRampToValueAtTime(c[0],b+d);break;case 2:this.g.frequency.exponentialRampToValueAtTime(c[0],b+d)}d+=1/60*c[1]}this.gain.gain.exponentialRampToValueAtTime(a*this.l,b+d);this.g.connect(this.gain).connect(this.h.destination);this.g.start(b);this.g.stop(b+d)}};class q{constructor(){this.o=(a,b=1,d="square",c=2,e=.5)=>new l(this.g,a,b,d,c,e);this.g=new AudioContext;this.v=1}};const t=(a,b=!0)=>{let d=null;b&&(d=document.createElement("div"),d.setAttribute("style","position: absolute; top: 0; left: 0; z-index: -1;"));b=document.createElement("canvas");b.setAttribute("style","position: absolute; top: 0; left: 0; z-index: -1;image-rendering: optimizeSpeed;image-rendering: pixelated;image-rendering: -moz-crisp-edges;");b.width=160;b.height=a;null!=d&&(d.appendChild(b),document.body.appendChild(d));a=b.getContext("2d");a.imageSmoothingEnabled=!1;return[b,a]},x=(a,b,d,c=1)=>
"rgba("+String(a|0)+","+String(b|0)+","+String(d|0)+","+String(Math.min(1,Math.max(c,0)))+")";function C(a){var b=window.innerWidth,d=window.innerHeight;let c=Math.min(b/a.width,d/a.height);1<=c&&(c=Math.floor(c));let e=a.g.style;e.width=String(c*a.width|0)+"px";e.height=String(c*a.height|0)+"px";e.left=String(b/2-c*a.width/2|0)+"px";e.top=String(d/2-c*a.height/2|0)+"px"}function D(a,b=1){a.h.globalAlpha=Math.min(1,Math.max(b,0));return a}
function E(a,b,d,c,e,g,f,h){if(!(null==b||0>=e||0>=g)){var k=a.h;d|=0;c|=0;e|=0;g|=0;f|=0;h|=0;a=0;0!=a&&k.save();0!=(a&1)&&(k.translate(e,0),k.scale(-1,1),f*=-1);0!=(a&2)&&(k.translate(0,g),k.scale(1,-1),h*=-1);k.drawImage(b,d,c,e,g,f,h,e,g);0!=a&&k.restore()}}function F(a,b,d,c,e){if(null!=b){var g=b.width/16|0,f=e;e=c-=d.length*(g+-16)/2;for(let k=0;k<d.length;++k){var h=d.charCodeAt(k);10==h?(e=c,f+=g+0):(E(a,b,h%16*g,(h/16|0)*g,g,g,e,f),e+=g+-16)}}}
class G{constructor(a,b=!0){this.clear=(d=255,c=d,e=c)=>this.setFillColor(d,c,e).fillRect();this.i=()=>this.g;[this.g,this.h]=t(a,b);b&&(window.addEventListener("resize",()=>C(this)),C(this))}get width(){return this.g.width}get height(){return this.g.height}setFillColor(a=255,b=a,d=b,c=1){this.h.fillStyle=x(a,b,d,c);return this}fillRect(a=0,b=0,d=this.width,c=this.height){this.h.fillRect(a|0,b|0,d|0,c|0);return this}};const H=(a,b,d=a.height)=>{let c=a.getContext("2d"),e=c.getImageData(0,0,a.width,a.height),g=Uint8ClampedArray.from(e.data),f;for(let h=b+1;h<d-1;++h){b=h*a.width+1;for(let k=1;k<a.width-1;++k,++b)if(255==g[4*b+3])for(let n=h-1;n<=h+1;++n)for(let m=k-1;m<=k+1;++m)f=n*a.width+m,0==g[4*f+3]&&(e.data[4*f]=0,e.data[4*f+1]=0,e.data[4*f+2]=0,e.data[4*f+3]=255)}c.putImageData(e,0,0)},J=(a,b)=>{var d=I;let c=new Image,e=document.createElement("canvas");c.onload=()=>{e.width=c.width;e.height=c.height;let g=
e.getContext("2d");g.drawImage(c,0,0);var f=e.width,h=e.height;let k=g.getImageData(0,0,f,h),n=f/8|0;h=h/8|0;for(let v=0;v<h;++v)for(let w=0;w<n;++w){var m=void 0,p=void 0,r=k,u=f,V=8*w;p=8*v;var W=8*(w+1),X=8*(v+1),y=a,Y=d[v*n+w];for(let z=p;z<X;++z)for(let A=V;A<W;++A){p=z*u+A;m=r.data;var B=4*p;m=[0,1,2,3][((m[B]/85|0)+(m[B+1]/85|0)+(m[B+2]/85|0))/3|0];m=Y[m];0>m?r.data[4*p+3]=0:(r.data[4*p]=y[3*m],r.data[4*p+1]=y[3*m+1],r.data[4*p+2]=y[3*m+2],r.data[4*p+3]=255)}}g.putImageData(k,0,0);b(c)};c.src=
"./b.png";return e},aa=a=>{let b=new G(176,!1);a(b);return b.i()},K=(a,b,d,c=[255,255,255],e=!1)=>{let g=document.createElement("canvas");g.width=16*b;g.height=16*d;var f=g.getContext("2d");f.imageSmoothingEnabled=!1;f.font=a;f.textAlign="center";f.fillStyle=x(...c,1);a=32;for(var h=2;8>h;++h)for(let k=0;16>k;++k)f.fillText(String.fromCharCode(a++),(k+.5)*b,(h+.67)*d);b=g.getContext("2d");f=b.getImageData(0,0,g.width,g.height);for(a=0;a<g.width*g.height;++a){for(h=0;3>h;++h)f.data[4*a+h]=c[h];f.data[4*
a+3]=127>f.data[4*a+3]?0:255}b.putImageData(f,0,0);e&&H(g,2*d,8*d);return g};function L(a,b,d){b?1!==a.g.get(d)&&a.g.set(d,3):0!==a.g.get(d)&&a.g.set(d,2)}function M(a,b,d,c){a.actions.set(b,[d,c]);a.h.push(d);void 0!==c&&a.h.push(c);return a}function N(a,b){a=a.g.get(b);return void 0==a?0:a}
class ba{constructor(){this.g=new Map;this.h=[];this.actions=new Map;window.addEventListener("keydown",a=>{L(this,!0,a.code);this.h.includes(a.code)&&a.preventDefault()});window.addEventListener("keyup",a=>{L(this,!1,a.code);this.h.includes(a.code)&&a.preventDefault()});window.addEventListener("contextmenu",a=>a.preventDefault());window.addEventListener("mousemove",()=>window.focus());window.addEventListener("mousedown",()=>window.focus())}update(){for(let a of this.g.keys())3===this.g.get(a)?this.g.set(a,
1):2===this.g.get(a)&&this.g.set(a,0)}};class ca{constructor(a,b){this.step=1;this.keyboard=a;this.audio=b}}function O(a,b){const d=16.66667*a.h.step;a.g+=b-a.i;a.g=Math.min(5*d,a.g);a.i=b;for(b=a.g/d|0;0<b--;)a.l(a.h),a.keyboard.update(),a.g-=d;a.j(a.m);window.requestAnimationFrame(c=>O(a,c))}function da(a,b=()=>{},d=()=>{},c=()=>{}){a.l=d;a.j=c;b(a.h);O(a,0)}class ea{constructor(){this.i=this.g=0;this.l=()=>{};this.j=()=>{};this.m=new G(144);this.keyboard=new ba;this.audio=new q;this.h=new ca(this.keyboard,this.audio)}};class P{constructor(a=0,b=0){this.x=a;this.y=b}};function Q(a,b,d,c){var e=a.g*Math.PI*2;e=new P(96*Math.cos(e)/2,12*Math.sin(e)/2);let g=Math.sin(a.j),f=Math.cos(a.j);a=new P(a.h.x+f*e.x+g*e.y,a.h.y-g*e.x+f*e.y);E(b,d,96,16*c,16,16,Math.round(a.x)-8,Math.round(a.y)-8)}class R{constructor(a,b=0){this.i=()=>.5>=this.g;this.h=new P(80,64);this.g=b;this.j=a;this.speed=1/120}update(a){this.g=(this.g+this.speed*a.step)%1}};const S=[0,56,62,-1],T=[0,56,36,-1],U=[0,16,32,-1],Z=[0,6,27,-1],I=[S,S,S,S,S,S,S,S,S,S,S,S,[0,56,32,-1],U,S,S,S,S,S,S,S,S,S,S,S,S,U,U,S,S,S,S,S,S,S,S,S,S,S,S,[0,47,27,-1],Z,T,T,T,T,T,T,T,T,T,T,T,T,Z,Z];function fa(a,b){a.i=J(b,()=>{a.loaded=!0;console.log("Loaded!")})}
function ha(a){const b=[[[85,85,170],[170,170,255],[255,255,255]],[[85,0,85],[170,85,170],[255,170,255]]];a.A=aa(d=>{let c,e,g;for(let f=0;11>f;++f)for(let h=0;10>h;++h)c=Number(h%2==f%2),e=16*h,g=16*f,d.setFillColor(...b[c][0]).fillRect(e,g,16,16).setFillColor(...b[c][2]).fillRect(e,g,15,15).setFillColor(...b[c][1]).fillRect(e+1,g+1,14,14)})}
function ia(a,b,d=0){d=b.width/2-72+a.j+d;let c,e=2*Math.PI/9,g=a.j/b.width*Math.PI*2,f;for(let h=1;0<=h;--h){f=0;for(let k=0;9>k;++k)" "!="Have fun!".charAt(k)&&(++f,c=-Math.round(16*Math.sin(a.h+e*f+g)),F(b,a.B,"Have fun!".charAt(k),Math.round(d+16*k)+h,b.height-48+h+c))}}
class ja{constructor(a){this.s=this.m=this.j=this.h=this.l=0;this.B=this.C=this.A=this.i=null;this.loaded=!1;a=a.audio;this.u=[];this.u.push(a.o([[128,4],[144,6],[160,12]],.3,"square",2,.5),a.o([[192,6],[240,6],[192,6],[160,20]],.7,"triangle",0,.2),a.o([[256,6],[192,8],[160,12]],.3,"sawtooth",1),a.o([[256,6],[320,8],[224,20]],.7,"sine",2,.1));a=Array(64);let b,d,c;for(let e=0;64>e;++e)b=e>>4,d=(e&12)>>2,c=e&3,a[3*e]=85*b,a[3*e+1]=85*d,a[3*e+2]=85*c;fa(this,a);ha(this);this.B=K("bold 24px Arial",32,
32,[255,170,0],!0);this.C=K("12px Arial",24,24);this.g=Array(2);this.g[0]=new R(Math.PI/8);this.g[1]=new R(-Math.PI/8,.5)}update(a){if(this.loaded){this.l=(this.l+.125*a.step)%4;this.h=(this.h+.05*a.step)%(2*Math.PI);this.j=(this.j+160/240*a.step)%160;this.m=(this.m+1*a.step)%232;{var b=a.keyboard;let c=b.actions.get("select");if(void 0===c)b=0;else{var d=N(b,c[0]);b=0==d&&void 0!==c[1]?N(b,c[1]):d}}3==b&&(this.u[this.s].play(1*a.audio.v),this.s=(this.s+1)%4);for(let c of this.g)c.update(a)}}};window.onload=()=>{let a;da(new ea,b=>{M(M(M(M(M(M(M(M(b.keyboard,"right","ArrowRight","KeyD"),"up","ArrowUp","KeyW"),"left","ArrowLeft","KeyA"),"down","ArrowDown","KeyS"),"fire1","KeyZ"),"fire2","KeyX"),"start","Enter"),"select","Space");b.audio.v=.5;a=new ja(b)},b=>a.update(b),b=>{var d=a;if(d.loaded){var c=d.A,e=Math.abs(b.height-c.height)/2,g=2*Math.PI/c.width;for(var f=0;f<b.width;++f){var h=Math.round(Math.sin(d.h+g*f)*e);E(b,c,f,h+e,1,b.height,f,0)}for(e=0;e<d.g.length;++e)c=d.g[e],c.i()&&
Q(c,b,d.i,e);g=32*[0,1,0,2][d.l|0];h=b.width/2;f=b.height/2+Math.round(16*Math.sin(d.h))+-8;var k=b.height/2+8,n=1-Math.abs(f-k)/64;c=D(b,.33).setFillColor(0);e=h;k+=16;var m=28*n;n=10*n;if(!(2>m||2>n)){e|=0;k|=0;m/=2;n/=2;var p=Math.round(n);for(let u=k-p;u<=k+p;++u){var r=Math.round(m*Math.sqrt(1-(u-k)*(u-k)/(n*n)));c.fillRect(e-r,u,2*r,1)}}E(D(b),d.i,g,0,32,32,h-16,f-16);for(e=0;e<d.g.length;++e)c=d.g[e],c.i()||Q(c,b,d.i,e);for(c=0;2>c;++c)ia(d,b,-c*b.width);b.setFillColor(0,0,0,.33).fillRect(0,
0,b.width,14);for(c=0;2>c;++c)F(b,d.C,"Press SPACE to play sounds.  ",b.width/2-d.m+232*c,-6)}else b.clear(0)})};
</script>
</body>
</html>
